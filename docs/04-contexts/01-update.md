---
slug: /contexts/update
id: learn-bot-contexts-update
sidebar_position: 2
sidebar_label: Ú©Ø§Ù†ØªÚ©Ø³Øª Update

last_update:
  date: '2026-02-18'
  author: 'hadi-rostami'
---

# Ú©Ù„Ø§Ø³ Update â€“ Ú©Ø§Ù†ØªÚ©Ø³Øª Ù…Ø¯ÛŒØ±ÛŒØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§

Ú©Ù„Ø§Ø³ `Update` Ù†Ù…Ø§ÛŒØ§Ù†â€ŒÚ¯Ø± context Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ†Ù„Ø§ÛŒÙ† (inline) Ø¯Ø±ÛŒØ§ÙØªâ€ŒØ´Ø¯Ù‡ Ø§Ø² Ø±ÙˆØ¨ÛŒÚ©Ø§Ø³Øª. Ø§ÛŒÙ† Ú©Ù„Ø§Ø³ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙˆØ³Ø· rubika Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯ `"update"` Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ùˆ Ø¨Ù‡ Ù‡Ù†Ø¯Ù„Ø± Ù¾Ø§Ø³ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„Ø§Ø³ (Properties)

| ÙˆÛŒÚ˜Ú¯ÛŒ                 | Ù†ÙˆØ¹                                                 | ØªÙˆØ¶ÛŒØ­Ø§Øª                                                        |
| --------------------- | --------------------------------------------------- | -------------------------------------------------------------- |
| `type`                | [UpdateTypeEnum](/docs/robot/models#updatetypeenum) | Ù†ÙˆØ¹ Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¯Ø±ÛŒØ§ÙØªÛŒ (Ù…Ø«Ù„Ø§Ù‹ `NewMessage`, `DeletedMessage`)      |
| `chat_id`             | `string`                                            | Ø´Ù†Ø§Ø³Ù‡ ÛŒÚ©ØªØ§ÛŒ Ú†ØªØŒ Ú¯Ø±ÙˆÙ‡ ÛŒØ§ Ú©Ø§Ù†Ø§Ù„                                  |
| `new_message?`        | [Message](/docs/robot/models#message)               | Ø¢Ø¨Ø¬Ú©Øª Ù¾ÛŒØ§Ù… Ø¬Ø¯ÛŒØ¯ (Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯)                                 |
| `updated_message?`    | [Message](/docs/robot/models#message)               | Ø¢Ø¨Ø¬Ú©Øª Ø§Ù¾Ø¯ÛŒØª Ù¾ÛŒØ§Ù… (Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯)                                |
| `removed_message_id?` | `string`                                            | Ø´Ù†Ø§Ø³Ù‡ Ù¾ÛŒØ§Ù… Ø­Ø°Ù Ø´Ø¯Ù‡                                             |
| `updated_payment?`    | [PaymentStatus](/docs/robot/models#paymentstatus)   | ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª (Ø¨Ø±Ø§ÛŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ)                             |
| `store`               | `Record<string, any>`                               | Ø­Ø§ÙØ¸Ù‡ Ù…ÙˆÙ‚Øª Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø¯Ø± Ø·ÙˆÙ„ Ú†Ø±Ø®Ù‡ Ø­ÛŒØ§Øª Ø¯Ø±Ø®ÙˆØ§Ø³Øª |
| `bot`                 | `Bot`                                               | Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Ù†Ù…ÙˆÙ†Ù‡ Ø±Ø¨Ø§Øª Ø¨Ø±Ø§ÛŒ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ØªØ¯Ù‡Ø§ÛŒ Ø³Ø·Ø­ Ù¾Ø§ÛŒÛŒÙ†     |

---

## Ù…ØªØ¯Ù‡Ø§ÛŒ Ù¾Ø§Ø³Ø®â€ŒØ¯Ù‡ÛŒ (Reply Methods)

ØªÙ…Ø§Ù…ÛŒ Ø§ÛŒÙ† Ù…ØªØ¯Ù‡Ø§ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ù¾ÛŒØ§Ù… Ú©Ø§Ø±Ø¨Ø± Reply Ù…ÛŒâ€ŒØ¯Ù‡Ù†Ø¯ (Ù¾Ø§Ø³Ø® Ù…ØªØµÙ„).

### `reply(text, ...options)`

Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ Ø³Ø§Ø¯Ù‡ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ù¾Ø§Ø³Ø®.

```ts
await ctx.reply("Ø³Ù„Ø§Ù…! Ù¾ÛŒØ§Ù… Ø´Ù…Ø§ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯.");
```

---

### `replyImage(file, text? , ...options)`

Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³ Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©Ù¾Ø´Ù†.

```ts
await ctx.replyImage("path/to/file");
```

---

### `replyVideo(file, text? , ...options)`

Ø§Ø±Ø³Ø§Ù„ ÙˆÛŒØ¯ÛŒÙˆ Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©Ù¾Ø´Ù†.

```ts
await ctx.replyVideo("path/to/file", "Ø§ÛŒÙ† ÛŒÚ© ÙˆÛŒØ¯ÛŒÙˆ Ø§Ø³Øª.");
```

---

### `replyGif(file, text? , ...options)`

Ø§Ø±Ø³Ø§Ù„ Ú¯ÛŒÙ Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©Ù¾Ø´Ù†.

```ts
await ctx.replyGif("path/to/file");
```

---

### `replySticker(sticker_id, ...options)`

Ø§Ø±Ø³Ø§Ù„ Ø§Ø³ØªÛŒÚ©Ø± Ø¨Ø§ Ø´Ù†Ø§Ø³Ù‡ Ø§Ø®ØªØµØ§ØµÛŒ.

```ts
await ctx.replySticker("sticker_12345");
```

---

### `replyMusic / replyVoice(file, text? , ...options)`

Ø§Ø±Ø³Ø§Ù„ ÙØ§ÛŒÙ„ ØµÙˆØªÛŒ (Ù…ÙˆØ²ÛŒÚ©) ÛŒØ§ ÙˆÛŒØ³ (Ù¾ÛŒØ§Ù… ØµÙˆØªÛŒ).

```ts
await ctx.replyMusic("path/to/file", "Ø§ÛŒÙ† ÛŒÚ© Ø¢Ù‡Ù†Ú¯ Ø§Ø³Øª.");
await ctx.replyVoice("path/to/file");
```

---

### `replyFile(file, text? , ...options)`

Ø§Ø±Ø³Ø§Ù„ Ù‡Ø± Ù†ÙˆØ¹ ÙØ§ÛŒÙ„ Ø¹Ù…ÙˆÙ…ÛŒ (Ø³Ù†Ø¯ØŒ PDFØŒ ZIP Ùˆ...).

```ts
await ctx.replyFile("path/to/file");
```

---

### `replyLocation(latitude, longitude, ...options)`

Ø§Ø±Ø³Ø§Ù„ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡.

```ts
await ctx.replyLocation("35.6997", "51.3380"); // ØªÙ‡Ø±Ø§Ù†
```

---

### `replyContact(firstName, lastName, phone, ...options)`

Ø§Ø±Ø³Ø§Ù„ Ú©Ø§Ø±Øª ØªÙ…Ø§Ø³ (Contact).

```ts
await ctx.replyContact("Ù‡Ø§Ø¯ÛŒ", "Ø±Ø³ØªÙ…ÛŒ", "989123456789");
```

---

### `replyPoll(question, options, auto_delete?)`

Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø±Ø³Ù†Ø¬ÛŒ (Poll) Ø¨Ù‡ Ú†Øª.

```ts
await ctx.replyPoll("Ú©Ø¯Ø§Ù… ÙØ±ÛŒÙ…â€ŒÙˆØ±Ú© Ø¨Ù‡ØªØ± Ø§Ø³ØªØŸ", ["React", "Vue", "Svelte"]);
```

---

###### âš  Ù†Ú©ØªÙ‡: ØªÙ…Ø§Ù… Ù…ØªØ¯Ù‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ Ø§Ø² Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ù…Ø´ØªØ±Ú©ÛŒ Ù…Ø«Ù„ chat_keypad (Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ Ú©ÛŒØ¨ÙˆØ±Ø¯)ØŒ inline_keypad (Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ù¾ÛŒØ§Ù…)ØŒ disable_notification (Ø¨ÛŒâ€ŒØµØ¯Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯Ù†) Ùˆ auto_delete (Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² Ø²Ù…Ø§Ù† Ù…Ø´Ø®Øµ) Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.

---

## Ù…ØªØ¯Ù‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ§Ù… Ùˆ Ú†Øª

---

### `forward(to_chat_id: string)`

ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ù¾ÛŒØ§Ù… ÙØ¹Ù„ÛŒ Ø¨Ù‡ Ú†Øª Ø¯ÛŒÚ¯Ø±.

```ts
await ctx.forward("b0..."); // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú†Øª Ø§Ø¯Ù…ÛŒÙ†
```

---

### `delete(message_id?)`

Ø­Ø°Ù Ù¾ÛŒØ§Ù… (Ù¾ÛŒØ´â€ŒÙØ±Ø¶: Ù¾ÛŒØ§Ù…ÛŒ Ú©Ù‡ Ø±Ø¨Ø§Øª Ø¨Ù‡ Ø¢Ù† Ù¾Ø§Ø³Ø® Ù…ÛŒâ€ŒØ¯Ù‡Ø¯).

```ts
await ctx.delete(); // Ø­Ø°Ù Ù¾ÛŒØ§Ù… ÙØ¹Ù„ÛŒ
await ctx.delete("message_id"); // Ø­Ø°Ù Ù¾ÛŒØ§Ù… Ø¯ÛŒÚ¯Ø±
```

---

### `editMessage(text?, inline_keypad?)`

ÙˆÛŒØ±Ø§ÛŒØ´ Ù…ØªÙ† ÛŒØ§ Ú©ÛŒØ¨ÙˆØ±Ø¯ Ù¾ÛŒØ§Ù… Ø§Ø±Ø³Ø§Ù„ÛŒ Ø±Ø¨Ø§Øª.

```ts
await ctx.editMessage("âœ… Ù…ØªÙ† ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯!", myInlineKeypad);
```

---

### `banUser(userId?)` / `unbanUser(userId?)`

Ø¨Ù† ÛŒØ§ Ø¢Ù†Ø¨Ù† Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ú†Øª. Ø§Ú¯Ø± userId Ù¾Ø§Ø³ Ø¯Ø§Ø¯Ù‡ Ù†Ø´ÙˆØ¯ØŒ ÙØ±Ø³ØªÙ†Ø¯Ù‡ Ù¾ÛŒØ§Ù… ÙØ¹Ù„ÛŒ Ù…Ø¯ Ù†Ø¸Ø± Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯.

```ts
// Ø¨Ù† Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø± Ù…Ø²Ø§Ø­Ù…
if (isSpam) {
  await ctx.banUser();
}
```

## ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ

### Ø­Ø§ÙØ¸Ù‡ Ù…ÙˆÙ‚Øª (`store`)

Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙ‚Øª Ø±Ø§ Ø¯Ø± Ø·ÙˆÙ„ Ù¾Ø±Ø¯Ø§Ø²Ø´ ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¯Ø± ctx.store Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¯Ø± ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø§Ø´Ù†Ø¯.

```ts
// Filter Ø§ÙˆÙ„
ctx.store.userData = await db.getUser(ctx.new_message.sender_id);

// Filter Ø¯ÙˆÙ…
const user = ctx.store.userData;
```

### Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Bot

Ø§Ø² Ø·Ø±ÛŒÙ‚ `ctx.bot` Ø¨Ù‡ ØªÙ…Ø§Ù… Ù…ØªØ¯Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ø±Ø¨Ø§Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¯Ø§Ø±ÛŒØ¯:

```ts
const botInfo = await ctx.bot.getMe();
```

## Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø§Ù…Ù„

```ts
import Bot, { Filters } from "rubika";

const bot = new Bot("YOUR_TOKEN");

bot.on("update", [Filters.isPrivate], async (ctx) => {
  // 1. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² store Ø¨Ø±Ø§ÛŒ Ú©Ø´ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
  ctx.store.user = await fetchUser(ctx.new_message.sender_id);

  if (!ctx.store.user) {
    return await ctx.reply("âŒ Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯.");
  }

  // 2. Ù¾Ø§Ø³Ø® Ù…ØªÙ†ÛŒ Ø¨Ø§ Ú©ÛŒØ¨ÙˆØ±Ø¯
  await ctx.reply("ğŸ‘‹ Ø³Ù„Ø§Ù…! Ú†Ù‡ Ú©Ù…Ú©ÛŒ Ø§Ø² Ø¯Ø³ØªÙ… Ø¨Ø±Ù…ÛŒâ€ŒØ¢ÛŒØ¯ØŸ", {
    keyboard: [["ğŸ“ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§", "ğŸ‘¤ Ù¾Ø±ÙˆÙØ§ÛŒÙ„"], ["âŒ Ø¨Ø³ØªÙ†"]],
    is_persistent: false,
  });

  // 3. Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªÙˆØ±Ø§Øª
  if (ctx.new_message.text === "/start") {
    await ctx.replyImage(
      "Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!",
      "welcome.jpg",
      undefined, // chat_keypad
      undefined, // inline_keypad
      true, // disable_notification
    );
  }

  // 4. ÙÙˆØ±ÙˆØ§Ø±Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù… Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ†
  if (ctx.new_message.text.includes("Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ")) {
    await ctx.forward("ADMIN_CHAT_ID");
    await ctx.reply("âœ… Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø´Ù…Ø§ Ø¨Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.");
  }
});

bot.run();
```

#### Ù†Ú©ØªÙ‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ: Ù…ØªØ¯ reply Ùˆ Ø³Ø§ÛŒØ± Ù…ØªØ¯Ù‡Ø§ÛŒ Ù…Ø´Ø§Ø¨Ù‡ØŒ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ ØªØ´Ø®ÛŒØµ Ù…ÛŒâ€ŒØ¯Ù‡Ù†Ø¯ Ú©Ù‡ Ø¢ÛŒØ§ Ù¾ÛŒØ§Ù… ÙˆØ±ÙˆØ¯ÛŒ Ø¯Ø§Ø±Ø§ÛŒ message_id Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª ÛŒØ§ Ø®ÛŒØ±. Ø§Ú¯Ø± Ù¾ÛŒØ§Ù… Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø¨Ø§Ø´Ø¯ØŒ Ø¨Ù‡â€ŒØ¬Ø§ÛŒ Ú©Ø±Ø´ Ú©Ø±Ø¯Ù†ØŒ Ø®Ø·Ø§ Ø±Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ bot.logger Ø«Ø¨Øª Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ù¾Ø§ÛŒØ¯Ø§Ø±ÛŒ Ø¨ÛŒØ´ØªØ± Ø±Ø¨Ø§Øª Ø¯Ø± Ù…Ø­ÛŒØ· Production Ù…ÛŒâ€ŒØ´ÙˆØ¯.
